version: '3.7'
services:
 app:
   build: .
   networks:
     - main
   volumes:
     - .:/app
   environment:
     - DEBUG=0
     - SECRET_KEY=testing
   depends_on:
     - db
 db:
   image: mysql:5.7 # fixed this version because the mysql 8 has ssl problems
   environment:
     MYSQL_DATABASE: guaraci_db
     MYSQL_ROOT_PASSWORD: root
   ports:
     - "3306:3306"
   networks:
     - main
 nginx:
   image: nginx
   volumes:
     - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
     - ./static:/usr/share/nginx/guaraci/static
   ports:
     - "80:80"
   networks:
     - main
   depends_on:
     - app

networks:
  main:
